@use "sass:math";
@use "sass:map";
@use "../media-queries/media-queries";
@use "../utils";

// Set this to `true` to disable the styles for the `TextContainer` component
$disable-text-container: false !default;

// Set this to `true` to disable the `headline-1` typography styles
$disable-headline-1: false !default;

// Set this to `true` to disable the `headline-2` typography styles
$disable-headline-2: false !default;

// Set this to `true` to disable the `headline-3` typography styles
$disable-headline-3: false !default;

// Set this to `true` to disable the `headline-4` typography styles
$disable-headline-4: false !default;

// Set this to `true` to disable the `headline-5` typography styles
$disable-headline-5: false !default;

// Set this to `true` to disable the `headline-6` typography styles
$disable-headline-6: false !default;

// Set this to `true` to disable the `subtitle-1` typography styles
$disable-subtitle-1: false !default;

// Set this to `true` to disable the `subtitle-2` typography styles
$disable-subtitle-2: false !default;

// Set this to `true` to disable the `body-1` typography styles
$disable-body-1: false !default;

// Set this to `true` to disable the `body-2` typography styles
$disable-body-2: false !default;

// Set this to `true` to disable the `caption` typography styles
$disable-caption: false !default;

// Set this to `true` to disable the `overline` typography styles
$disable-overline: false !default;

// A small utility function to get the letter spacing based on tracking and
// font-size
//
// @internal
// @param {number} tracking - The tracking to use
// @param {number} font-size - The font size to use
// @returns {number} the letter spacing value in em
@function get-letter-spacing($tracking, $font-size) {
  @return math.div($tracking, $font-size * 16) * 1em;
}

$font-weight-thin: 100 !default;
$font-weight-light: 300 !default;
$font-weight-regular: 400 !default;
$font-weight-medium: 500 !default;
$font-weight-bold: 700 !default;
$font-weight-semi-bold: 800 !default;
$font-weight-black: 900 !default;

// A Map of all the font weights.
//
// @type Map
// @prop {number} thin [$font-weight-thin] - The thin font weight value.
// @prop {number} light [$font-weight-light] - The light font weight value.
// @prop {number} regular [$font-weight-regular] - The regular font weight
// value.
// @prop {number} medium [$font-weight-medium] - The medium font weight
// value.
// @prop {number} bold [$font-weight-bold] - The bold font weight value.
// @prop {number} semi-bold [$font-weight-semi-bold] - The semi-bold font
// weight value.
// @prop {number} black [$font-weight-black] - The black font weight value.
$font-weights: (
  thin: $font-weight-thin,
  light: $font-weight-light,
  regular: $font-weight-regular,
  medium: $font-weight-medium,
  bold: $font-weight-bold,
  semi-bold: $font-weight-semi-bold,
  "black": $font-weight-black,
) !default;

$text-alignments: left center right !default;
$text-decorations: underline overline line-through none !default;
$text-transforms: capitalize uppercase lowercase !default;
$font-styles: normal italic oblique !default;

// The font family to use throughout the entire application.
//
// @example Changing the Font
// ```scss
// @use "react-md" with (
//   $font-family: string.unquote("'Open Sans', Koulen, 'Roboto Flex', sans-serif")
// ):
//
// @include react-md.typography;
// ```
//
// @type string
$font-family: Roboto, sans-serif !default;
$font-size: 1rem !default;
$font-weight: $font-weight-regular !default;
$line-height: 1.5rem !default;

// The base styles for typography.
// @type Map
$base-recommended-font-styles: (
  font-family: var(--rmd-font-family),
  overflow: inherit,
  overflow-wrap: break-word,
  text-overflow: inherit,
  -moz-osx-font-smoothing: grayscale,
  -webkit-font-smoothing: antialiased,
);
$base-custom-font-styles: () !default;
$base-font-styles: map.merge(
  $base-recommended-font-styles,
  $base-custom-font-styles
);

$headline-1-recommended-styles: (
  font-size: 6rem,
  line-height: 6rem,
  font-weight: map.get($font-weights, light),
  letter-spacing: get-letter-spacing(-1.5, 6),
);
$headline-1-custom-styles: () !default;
$headline-1-styles: map.merge(
  $headline-1-recommended-styles,
  $headline-1-custom-styles
) !default;
$headline-2-recommended-styles: (
  font-size: 3.75rem,
  line-height: 3.75rem,
  font-weight: map.get($font-weights, light),
  letter-spacing: get-letter-spacing(-0.5, 3.75),
);
$headline-2-custom-styles: () !default;
$headline-2-styles: map.merge(
  $headline-2-recommended-styles,
  $headline-2-custom-styles
) !default;
$headline-3-recommended-styles: (
  font-size: 3rem,
  line-height: 3.125rem,
  font-weight: map.get($font-weights, regular),
  letter-spacing: normal,
);
$headline-3-custom-styles: () !default;
$headline-3-styles: map.merge(
  $headline-3-recommended-styles,
  $headline-3-custom-styles
) !default;
$headline-4-recommended-styles: (
  font-size: 2.125rem,
  line-height: 2.5rem,
  font-weight: map.get($font-weights, regular),
  letter-spacing: get-letter-spacing(0.25, 2.125),
);
$headline-4-custom-styles: () !default;
$headline-4-styles: map.merge(
  $headline-4-recommended-styles,
  $headline-4-custom-styles
) !default;
$headline-5-recommended-styles: (
  font-size: 1.5rem,
  line-height: 2rem,
  font-weight: map.get($font-weights, regular),
  letter-spacing: normal,
);
$headline-5-custom-styles: () !default;
$headline-5-styles: map.merge(
  $headline-5-recommended-styles,
  $headline-5-custom-styles
) !default;
$headline-6-recommended-styles: (
  font-size: 1.25rem,
  line-height: 2rem,
  font-weight: map.get($font-weights, medium),
  letter-spacing: get-letter-spacing(0.25, 1.25),
);
$headline-6-custom-styles: () !default;
$headline-6-styles: map.merge(
  $headline-6-recommended-styles,
  $headline-6-custom-styles
) !default;
$subtitle-1-recommended-styles: (
  font-size: 1rem,
  line-height: 1.75rem,
  font-weight: map.get($font-weights, regular),
  letter-spacing: get-letter-spacing(0.15, 1),
);
$subtitle-1-custom-styles: () !default;
$subtitle-1-styles: map.merge(
  $subtitle-1-recommended-styles,
  $subtitle-1-custom-styles
) !default;
$subtitle-2-recommended-styles: (
  font-size: 0.875rem,
  line-height: 1.375rem,
  font-weight: map.get($font-weights, medium),
  letter-spacing: get-letter-spacing(0.1, 0.875),
);
$subtitle-2-custom-styles: () !default;
$subtitle-2-styles: map.merge(
  $subtitle-2-recommended-styles,
  $subtitle-2-custom-styles
) !default;
$body-1-recommended-styles: (
  font-size: 1rem,
  line-height: 1.5rem,
  font-weight: map.get($font-weights, regular),
  letter-spacing: get-letter-spacing(0.5, 0.875),
);
$body-1-custom-styles: () !default;
$body-1-styles: map.merge(
  $body-1-recommended-styles,
  $body-1-custom-styles
) !default;
$body-2-recommended-styles: (
  font-size: 0.875rem,
  line-height: 1.25rem,
  font-weight: map.get($font-weights, regular),
  letter-spacing: get-letter-spacing(0.25, 0.875),
);
$body-2-custom-styles: () !default;
$body-2-styles: map.merge(
  $body-2-recommended-styles,
  $body-2-custom-styles
) !default;
$caption-recommended-styles: (
  font-size: 0.75rem,
  line-height: 1.25rem,
  font-weight: map.get($font-weights, regular),
  letter-spacing: get-letter-spacing(0.4, 0.75),
);
$caption-custom-styles: () !default;
$caption-styles: map.merge(
  $caption-recommended-styles,
  $caption-custom-styles
) !default;
$overline-recommended-styles: (
  font-size: 0.75rem,
  line-height: 2rem,
  font-weight: map.get($font-weights, medium),
  letter-spacing: get-letter-spacing(2, 0.75),
);
$overline-custom-styles: () !default;
$overline-styles: map.merge(
  $overline-recommended-styles,
  $overline-custom-styles
) !default;
$button-recommended-styles: map.merge(
  $base-font-styles,
  (
    font-size: 0.875rem,
    font-weight: map.get($font-weights, medium),
    letter-spacing: get-letter-spacing(1.25, 0.875),
    line-height: 2.25rem,
    // buttons with multiple lines of text look terrible because of the large
    // line-height. You normally want to use a different component if the
    // clickable area has so much content to line-wrap
    line-wrap: nowrap,
  )
);
$button-custom-styles: () !default;
$button-styles: map.merge(
  $button-recommended-styles,
  $button-custom-styles
) !default;

$text-container-padding: 1rem !default;
// since everything has `box-sizing: border-box`, make sure the width is 65
// characters + left and right padding so the text is _really_ 65ch
$text-line-length: calc(65ch + $text-container-padding * 2) !default;

$typography-variables: (
  line-length,
  text-container-padding,
  font-size,
  font-family,
  font-weight,
  line-height
);

@function typography-get-var($name, $fallback: null) {
  $var: utils.get-var-name($typography-variables, $name, "typography");
  @if $fallback {
    @return var(#{$var}, #{$fallback});
  }

  @return var(#{$var});
}

@mixin typography-set-var($name, $value) {
  @if $value {
    #{utils.get-var-name($typography-variables, $name, "typography")}: #{$value};
  }
}

@mixin typography-use-var($property, $name: $property, $fallback: null) {
  #{$property}: typography-get-var($name, $fallback);
}

@mixin typography-text-container-styles(
  $disabled: $disable-text-container,
  $disable-layer: false
) {
  @if not $disabled {
    @include utils.optional-layer(typography, $disable-layer) {
      .rmd-text-container {
        @include typography-use-var(max-width, line-length);
        @include typography-use-var(padding, text-container-padding);

        display: block;
        margin: 0 auto;
        width: 100%;
      }
    }
  }
}

@mixin typography-base-styles($disable-layer: false) {
  @include utils.optional-layer(typography, $disable-layer) {
    .rmd-typography {
      @include utils.map-to-styles($base-font-styles);

      @if not $disable-headline-1 {
        &--headline-1 {
          @include utils.map-to-styles($headline-1-styles);
        }
      }

      @if not $disable-headline-2 {
        &--headline-2 {
          @include utils.map-to-styles($headline-2-styles);
        }
      }

      @if not $disable-headline-3 {
        &--headline-3 {
          @include utils.map-to-styles($headline-3-styles);
        }
      }

      @if not $disable-headline-4 {
        &--headline-4 {
          @include utils.map-to-styles($headline-4-styles);
        }
      }

      @if not $disable-headline-5 {
        &--headline-5 {
          @include utils.map-to-styles($headline-5-styles);
        }
      }

      @if not $disable-headline-6 {
        &--headline-6 {
          @include utils.map-to-styles($headline-6-styles);
        }
      }

      @if not $disable-subtitle-1 {
        &--subtitle-1 {
          @include utils.map-to-styles($subtitle-1-styles);
        }
      }

      @if not $disable-subtitle-2 {
        &--subtitle-2 {
          @include utils.map-to-styles($subtitle-2-styles);
        }
      }

      @if not $disable-body-1 {
        &--body-1 {
          @include utils.map-to-styles($body-1-styles);
        }
      }

      @if not $disable-body-2 {
        &--body-2 {
          @include utils.map-to-styles($body-2-styles);
        }
      }

      @if not $disable-caption {
        &--caption {
          @include utils.map-to-styles($caption-styles);
        }
      }

      @if not $disable-overline {
        &--overline {
          @include utils.map-to-styles($overline-styles);
        }
      }
    }
  }
}

@mixin text-overflow($white-space: nowrap) {
  overflow: hidden;
  overflow-wrap: anywhere;
  text-overflow: ellipsis;
  white-space: $white-space;
}

@mixin line-clamp($lines: 2) {
  // stylelint-disable order/properties-alphabetical-order
  -webkit-box-orient: vertical;
  -webkit-line-clamp: $lines;
  display: -webkit-box;
}

@mixin typography-variables {
  @include typography-set-var(font-family, $font-family);
  @if $font-size {
    @include typography-set-var(font-size, $font-size);
  }

  @if $font-weight {
    @include typography-set-var(font-weight, $font-weight);
  }

  @if $line-height {
    @include typography-set-var(line-height, $line-height);
  }

  @if not $disable-text-container {
    @include typography-set-var(line-length, $text-line-length);
    @include typography-set-var(
      text-container-padding,
      $text-container-padding
    );
  }
}

@mixin typography-html-body-styles {
  @include typography-use-var(font-family);
  @include typography-use-var(font-size);
  @include typography-use-var(font-weight);
  @include typography-use-var(line-height);
}

@mixin typography-styles($disable-layer: false) {
  @include utils.optional-layer(typography, $disable-layer) {
    @include typography-text-container-styles($disable-layer: true);
    @include typography-base-styles(true);
  }
}
